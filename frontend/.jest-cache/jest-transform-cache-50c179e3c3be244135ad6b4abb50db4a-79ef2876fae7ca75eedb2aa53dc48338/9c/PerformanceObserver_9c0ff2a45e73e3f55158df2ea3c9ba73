883bb8efd66746e9187147b5b4f04e02
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.PerformanceObserverEntryList = void 0;
exports.warnNoNativePerformanceObserver = warnNoNativePerformanceObserver;
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _warnOnce = _interopRequireDefault(require("../Utilities/warnOnce"));
var _NativePerformanceObserver = _interopRequireDefault(require("./NativePerformanceObserver"));
var _PerformanceEntry = require("./PerformanceEntry");
var _RawPerformanceEntry = require("./RawPerformanceEntry");
var PerformanceObserverEntryList = exports.PerformanceObserverEntryList = function () {
  function PerformanceObserverEntryList(entries) {
    (0, _classCallCheck2.default)(this, PerformanceObserverEntryList);
    this._entries = entries;
  }
  return (0, _createClass2.default)(PerformanceObserverEntryList, [{
    key: "getEntries",
    value: function getEntries() {
      return this._entries;
    }
  }, {
    key: "getEntriesByType",
    value: function getEntriesByType(type) {
      return this._entries.filter(function (entry) {
        return entry.entryType === type;
      });
    }
  }, {
    key: "getEntriesByName",
    value: function getEntriesByName(name, type) {
      if (type === undefined) {
        return this._entries.filter(function (entry) {
          return entry.name === name;
        });
      } else {
        return this._entries.filter(function (entry) {
          return entry.name === name && entry.entryType === type;
        });
      }
    }
  }]);
}();
var observerCountPerEntryType = new Map();
var registeredObservers = new Map();
var isOnPerformanceEntryCallbackSet = false;
var onPerformanceEntry = function onPerformanceEntry() {
  var _entryResult$entries;
  if (!_NativePerformanceObserver.default) {
    return;
  }
  var entryResult = _NativePerformanceObserver.default.popPendingEntries();
  var rawEntries = (_entryResult$entries = entryResult == null ? void 0 : entryResult.entries) != null ? _entryResult$entries : [];
  var droppedEntriesCount = entryResult == null ? void 0 : entryResult.droppedEntriesCount;
  if (rawEntries.length === 0) {
    return;
  }
  var entries = rawEntries.map(_RawPerformanceEntry.rawToPerformanceEntry);
  var _loop = function _loop(observerConfig) {
    var entriesForObserver = entries.filter(function (entry) {
      if (!observerConfig.entryTypes.has(entry.entryType)) {
        return false;
      }
      var durationThreshold = observerConfig.entryTypes.get(entry.entryType);
      return entry.duration >= (durationThreshold != null ? durationThreshold : 0);
    });
    observerConfig.callback(new PerformanceObserverEntryList(entriesForObserver), _observer, droppedEntriesCount);
  };
  for (var _ref of registeredObservers.entries()) {
    var _ref2 = (0, _slicedToArray2.default)(_ref, 2);
    var _observer = _ref2[0];
    var observerConfig = _ref2[1];
    _loop(observerConfig);
  }
};
function warnNoNativePerformanceObserver() {
  (0, _warnOnce.default)('missing-native-performance-observer', 'Missing native implementation of PerformanceObserver');
}
function applyDurationThresholds() {
  var durationThresholds = Array.from(registeredObservers.values()).map(function (config) {
    return config.entryTypes;
  }).reduce(function (accumulator, currentValue) {
    return union(accumulator, currentValue);
  }, new Map());
  for (var _ref3 of durationThresholds) {
    var _ref4 = (0, _slicedToArray2.default)(_ref3, 2);
    var entryType = _ref4[0];
    var durationThreshold = _ref4[1];
    _NativePerformanceObserver.default == null ? void 0 : _NativePerformanceObserver.default.setDurationThreshold((0, _RawPerformanceEntry.performanceEntryTypeToRaw)(entryType), durationThreshold != null ? durationThreshold : 0);
  }
}
var PerformanceObserver = exports.default = function () {
  function PerformanceObserver(callback) {
    (0, _classCallCheck2.default)(this, PerformanceObserver);
    this._callback = callback;
  }
  return (0, _createClass2.default)(PerformanceObserver, [{
    key: "observe",
    value: function observe(options) {
      var _registeredObservers$;
      if (!_NativePerformanceObserver.default) {
        warnNoNativePerformanceObserver();
        return;
      }
      this._validateObserveOptions(options);
      var requestedEntryTypes;
      if (options.entryTypes) {
        this._type = 'multiple';
        requestedEntryTypes = new Map(options.entryTypes.map(function (t) {
          return [t, undefined];
        }));
      } else {
        this._type = 'single';
        requestedEntryTypes = new Map([[options.type, options.durationThreshold]]);
      }
      var currentEntryTypes = (_registeredObservers$ = registeredObservers.get(this)) == null ? void 0 : _registeredObservers$.entryTypes;
      var nextEntryTypes = currentEntryTypes ? union(requestedEntryTypes, currentEntryTypes) : requestedEntryTypes;
      if (currentEntryTypes && currentEntryTypes.size === nextEntryTypes.size) {
        return;
      }
      registeredObservers.set(this, {
        callback: this._callback,
        entryTypes: nextEntryTypes
      });
      if (!isOnPerformanceEntryCallbackSet) {
        _NativePerformanceObserver.default.setOnPerformanceEntryCallback(onPerformanceEntry);
        isOnPerformanceEntryCallbackSet = true;
      }
      var newEntryTypes = currentEntryTypes ? difference(new Set(requestedEntryTypes.keys()), new Set(currentEntryTypes.keys())) : new Set(requestedEntryTypes.keys());
      for (var type of newEntryTypes) {
        var _observerCountPerEntr;
        if (!observerCountPerEntryType.has(type)) {
          var rawType = (0, _RawPerformanceEntry.performanceEntryTypeToRaw)(type);
          _NativePerformanceObserver.default.startReporting(rawType);
        }
        observerCountPerEntryType.set(type, ((_observerCountPerEntr = observerCountPerEntryType.get(type)) != null ? _observerCountPerEntr : 0) + 1);
      }
      applyDurationThresholds();
    }
  }, {
    key: "disconnect",
    value: function disconnect() {
      if (!_NativePerformanceObserver.default) {
        warnNoNativePerformanceObserver();
        return;
      }
      var observerConfig = registeredObservers.get(this);
      if (!observerConfig) {
        return;
      }
      for (var type of observerConfig.entryTypes.keys()) {
        var _observerCountPerEntr2;
        var numberOfObserversForThisType = (_observerCountPerEntr2 = observerCountPerEntryType.get(type)) != null ? _observerCountPerEntr2 : 0;
        if (numberOfObserversForThisType === 1) {
          observerCountPerEntryType.delete(type);
          _NativePerformanceObserver.default.stopReporting((0, _RawPerformanceEntry.performanceEntryTypeToRaw)(type));
        } else if (numberOfObserversForThisType !== 0) {
          observerCountPerEntryType.set(type, numberOfObserversForThisType - 1);
        }
      }
      registeredObservers.delete(this);
      if (registeredObservers.size === 0) {
        _NativePerformanceObserver.default.setOnPerformanceEntryCallback(undefined);
        isOnPerformanceEntryCallbackSet = false;
      }
      applyDurationThresholds();
    }
  }, {
    key: "_validateObserveOptions",
    value: function _validateObserveOptions(options) {
      var type = options.type,
        entryTypes = options.entryTypes,
        durationThreshold = options.durationThreshold;
      if (!type && !entryTypes) {
        throw new TypeError("Failed to execute 'observe' on 'PerformanceObserver': An observe() call must not include both entryTypes and type arguments.");
      }
      if (entryTypes && type) {
        throw new TypeError("Failed to execute 'observe' on 'PerformanceObserver': An observe() call must include either entryTypes or type arguments.");
      }
      if (this._type === 'multiple' && type) {
        throw new Error("Failed to execute 'observe' on 'PerformanceObserver': This observer has performed observe({entryTypes:...}, therefore it cannot perform observe({type:...})");
      }
      if (this._type === 'single' && entryTypes) {
        throw new Error("Failed to execute 'observe' on 'PerformanceObserver': This PerformanceObserver has performed observe({type:...}, therefore it cannot perform observe({entryTypes:...})");
      }
      if (entryTypes && durationThreshold !== undefined) {
        throw new TypeError("Failed to execute 'observe' on 'PerformanceObserver': An observe() call must not include both entryTypes and durationThreshold arguments.");
      }
    }
  }]);
}();
PerformanceObserver.supportedEntryTypes = Object.freeze(['mark', 'measure', 'event']);
function union(a, b) {
  var res = new Map();
  for (var _ref5 of a) {
    var _ref6 = (0, _slicedToArray2.default)(_ref5, 2);
    var k = _ref6[0];
    var v = _ref6[1];
    if (!b.has(k)) {
      res.set(k, v);
    } else {
      var _b$get;
      res.set(k, Math.min(v != null ? v : 0, (_b$get = b.get(k)) != null ? _b$get : 0));
    }
  }
  return res;
}
function difference(a, b) {
  return new Set((0, _toConsumableArray2.default)(a).filter(function (x) {
    return !b.has(x);
  }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfd2Fybk9uY2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9OYXRpdmVQZXJmb3JtYW5jZU9ic2VydmVyIiwiX1BlcmZvcm1hbmNlRW50cnkiLCJfUmF3UGVyZm9ybWFuY2VFbnRyeSIsIlBlcmZvcm1hbmNlT2JzZXJ2ZXJFbnRyeUxpc3QiLCJleHBvcnRzIiwiZW50cmllcyIsIl9jbGFzc0NhbGxDaGVjazIiLCJkZWZhdWx0IiwiX2VudHJpZXMiLCJfY3JlYXRlQ2xhc3MyIiwia2V5IiwidmFsdWUiLCJnZXRFbnRyaWVzIiwiZ2V0RW50cmllc0J5VHlwZSIsInR5cGUiLCJmaWx0ZXIiLCJlbnRyeSIsImVudHJ5VHlwZSIsImdldEVudHJpZXNCeU5hbWUiLCJuYW1lIiwidW5kZWZpbmVkIiwib2JzZXJ2ZXJDb3VudFBlckVudHJ5VHlwZSIsIk1hcCIsInJlZ2lzdGVyZWRPYnNlcnZlcnMiLCJpc09uUGVyZm9ybWFuY2VFbnRyeUNhbGxiYWNrU2V0Iiwib25QZXJmb3JtYW5jZUVudHJ5IiwiX2VudHJ5UmVzdWx0JGVudHJpZXMiLCJOYXRpdmVQZXJmb3JtYW5jZU9ic2VydmVyIiwiZW50cnlSZXN1bHQiLCJwb3BQZW5kaW5nRW50cmllcyIsInJhd0VudHJpZXMiLCJkcm9wcGVkRW50cmllc0NvdW50IiwibGVuZ3RoIiwibWFwIiwicmF3VG9QZXJmb3JtYW5jZUVudHJ5IiwiX2xvb3AiLCJvYnNlcnZlckNvbmZpZyIsImVudHJpZXNGb3JPYnNlcnZlciIsImVudHJ5VHlwZXMiLCJoYXMiLCJkdXJhdGlvblRocmVzaG9sZCIsImdldCIsImR1cmF0aW9uIiwiY2FsbGJhY2siLCJvYnNlcnZlciIsIl9yZWYiLCJfcmVmMiIsIl9zbGljZWRUb0FycmF5MiIsIndhcm5Ob05hdGl2ZVBlcmZvcm1hbmNlT2JzZXJ2ZXIiLCJ3YXJuT25jZSIsImFwcGx5RHVyYXRpb25UaHJlc2hvbGRzIiwiZHVyYXRpb25UaHJlc2hvbGRzIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIiwiY29uZmlnIiwicmVkdWNlIiwiYWNjdW11bGF0b3IiLCJjdXJyZW50VmFsdWUiLCJ1bmlvbiIsIl9yZWYzIiwiX3JlZjQiLCJzZXREdXJhdGlvblRocmVzaG9sZCIsInBlcmZvcm1hbmNlRW50cnlUeXBlVG9SYXciLCJQZXJmb3JtYW5jZU9ic2VydmVyIiwiX2NhbGxiYWNrIiwib2JzZXJ2ZSIsIm9wdGlvbnMiLCJfcmVnaXN0ZXJlZE9ic2VydmVycyQiLCJfdmFsaWRhdGVPYnNlcnZlT3B0aW9ucyIsInJlcXVlc3RlZEVudHJ5VHlwZXMiLCJfdHlwZSIsInQiLCJjdXJyZW50RW50cnlUeXBlcyIsIm5leHRFbnRyeVR5cGVzIiwic2l6ZSIsInNldCIsInNldE9uUGVyZm9ybWFuY2VFbnRyeUNhbGxiYWNrIiwibmV3RW50cnlUeXBlcyIsImRpZmZlcmVuY2UiLCJTZXQiLCJrZXlzIiwiX29ic2VydmVyQ291bnRQZXJFbnRyIiwicmF3VHlwZSIsInN0YXJ0UmVwb3J0aW5nIiwiZGlzY29ubmVjdCIsIl9vYnNlcnZlckNvdW50UGVyRW50cjIiLCJudW1iZXJPZk9ic2VydmVyc0ZvclRoaXNUeXBlIiwiZGVsZXRlIiwic3RvcFJlcG9ydGluZyIsIlR5cGVFcnJvciIsIkVycm9yIiwic3VwcG9ydGVkRW50cnlUeXBlcyIsIk9iamVjdCIsImZyZWV6ZSIsImEiLCJiIiwicmVzIiwiX3JlZjUiLCJfcmVmNiIsImsiLCJ2IiwiX2IkZ2V0IiwiTWF0aCIsIm1pbiIsIl90b0NvbnN1bWFibGVBcnJheTIiLCJ4Il0sInNvdXJjZXMiOlsiUGVyZm9ybWFuY2VPYnNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGZvcm1hdFxuICogQGZsb3cgc3RyaWN0XG4gKi9cblxuaW1wb3J0IHR5cGUge0hpZ2hSZXNUaW1lU3RhbXAsIFBlcmZvcm1hbmNlRW50cnlUeXBlfSBmcm9tICcuL1BlcmZvcm1hbmNlRW50cnknO1xuXG5pbXBvcnQgd2Fybk9uY2UgZnJvbSAnLi4vVXRpbGl0aWVzL3dhcm5PbmNlJztcbmltcG9ydCBOYXRpdmVQZXJmb3JtYW5jZU9ic2VydmVyIGZyb20gJy4vTmF0aXZlUGVyZm9ybWFuY2VPYnNlcnZlcic7XG5pbXBvcnQge1BlcmZvcm1hbmNlRW50cnl9IGZyb20gJy4vUGVyZm9ybWFuY2VFbnRyeSc7XG5pbXBvcnQge1xuICBwZXJmb3JtYW5jZUVudHJ5VHlwZVRvUmF3LFxuICByYXdUb1BlcmZvcm1hbmNlRW50cnksXG59IGZyb20gJy4vUmF3UGVyZm9ybWFuY2VFbnRyeSc7XG5cbmV4cG9ydCB0eXBlIFBlcmZvcm1hbmNlRW50cnlMaXN0ID0gJFJlYWRPbmx5QXJyYXk8UGVyZm9ybWFuY2VFbnRyeT47XG5cbmV4cG9ydCBjbGFzcyBQZXJmb3JtYW5jZU9ic2VydmVyRW50cnlMaXN0IHtcbiAgX2VudHJpZXM6IFBlcmZvcm1hbmNlRW50cnlMaXN0O1xuXG4gIGNvbnN0cnVjdG9yKGVudHJpZXM6IFBlcmZvcm1hbmNlRW50cnlMaXN0KSB7XG4gICAgdGhpcy5fZW50cmllcyA9IGVudHJpZXM7XG4gIH1cblxuICBnZXRFbnRyaWVzKCk6IFBlcmZvcm1hbmNlRW50cnlMaXN0IHtcbiAgICByZXR1cm4gdGhpcy5fZW50cmllcztcbiAgfVxuXG4gIGdldEVudHJpZXNCeVR5cGUodHlwZTogUGVyZm9ybWFuY2VFbnRyeVR5cGUpOiBQZXJmb3JtYW5jZUVudHJ5TGlzdCB7XG4gICAgcmV0dXJuIHRoaXMuX2VudHJpZXMuZmlsdGVyKGVudHJ5ID0+IGVudHJ5LmVudHJ5VHlwZSA9PT0gdHlwZSk7XG4gIH1cblxuICBnZXRFbnRyaWVzQnlOYW1lKFxuICAgIG5hbWU6IHN0cmluZyxcbiAgICB0eXBlPzogUGVyZm9ybWFuY2VFbnRyeVR5cGUsXG4gICk6IFBlcmZvcm1hbmNlRW50cnlMaXN0IHtcbiAgICBpZiAodHlwZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZW50cmllcy5maWx0ZXIoZW50cnkgPT4gZW50cnkubmFtZSA9PT0gbmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLl9lbnRyaWVzLmZpbHRlcihcbiAgICAgICAgZW50cnkgPT4gZW50cnkubmFtZSA9PT0gbmFtZSAmJiBlbnRyeS5lbnRyeVR5cGUgPT09IHR5cGUsXG4gICAgICApO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgdHlwZSBQZXJmb3JtYW5jZU9ic2VydmVyQ2FsbGJhY2sgPSAoXG4gIGxpc3Q6IFBlcmZvcm1hbmNlT2JzZXJ2ZXJFbnRyeUxpc3QsXG4gIG9ic2VydmVyOiBQZXJmb3JtYW5jZU9ic2VydmVyLFxuICAvLyBUaGUgbnVtYmVyIG9mIGJ1ZmZlcmVkIGVudHJpZXMgd2hpY2ggZ290IGRyb3BwZWQgZnJvbSB0aGUgYnVmZmVyIGR1ZSB0byB0aGUgYnVmZmVyIGJlaW5nIGZ1bGw6XG4gIGRyb3BwZWRFbnRyeUNvdW50PzogbnVtYmVyLFxuKSA9PiB2b2lkO1xuXG5leHBvcnQgdHlwZSBQZXJmb3JtYW5jZU9ic2VydmVySW5pdCA9XG4gIHwge1xuICAgICAgZW50cnlUeXBlczogQXJyYXk8UGVyZm9ybWFuY2VFbnRyeVR5cGU+LFxuICAgIH1cbiAgfCB7XG4gICAgICB0eXBlOiBQZXJmb3JtYW5jZUVudHJ5VHlwZSxcbiAgICAgIGR1cmF0aW9uVGhyZXNob2xkPzogSGlnaFJlc1RpbWVTdGFtcCxcbiAgICB9O1xuXG50eXBlIFBlcmZvcm1hbmNlT2JzZXJ2ZXJDb25maWcgPSB7fFxuICBjYWxsYmFjazogUGVyZm9ybWFuY2VPYnNlcnZlckNhbGxiYWNrLFxuICAvLyBNYXAgb2Yge2VudHJ5VHlwZTogZHVyYXRpb25UaHJlc2hvbGR9XG4gIGVudHJ5VHlwZXM6ICRSZWFkT25seU1hcDxQZXJmb3JtYW5jZUVudHJ5VHlwZSwgP251bWJlcj4sXG58fTtcblxuY29uc3Qgb2JzZXJ2ZXJDb3VudFBlckVudHJ5VHlwZTogTWFwPFBlcmZvcm1hbmNlRW50cnlUeXBlLCBudW1iZXI+ID0gbmV3IE1hcCgpO1xuY29uc3QgcmVnaXN0ZXJlZE9ic2VydmVyczogTWFwPFBlcmZvcm1hbmNlT2JzZXJ2ZXIsIFBlcmZvcm1hbmNlT2JzZXJ2ZXJDb25maWc+ID1cbiAgbmV3IE1hcCgpO1xubGV0IGlzT25QZXJmb3JtYW5jZUVudHJ5Q2FsbGJhY2tTZXQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuLy8gVGhpcyBpcyBhIGNhbGxiYWNrIHRoYXQgZ2V0cyBzY2hlZHVsZWQgYW5kIHBlcmlvZGljYWxseSBjYWxsZWQgZnJvbSB0aGUgbmF0aXZlIHNpZGVcbmNvbnN0IG9uUGVyZm9ybWFuY2VFbnRyeSA9ICgpID0+IHtcbiAgaWYgKCFOYXRpdmVQZXJmb3JtYW5jZU9ic2VydmVyKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGVudHJ5UmVzdWx0ID0gTmF0aXZlUGVyZm9ybWFuY2VPYnNlcnZlci5wb3BQZW5kaW5nRW50cmllcygpO1xuICBjb25zdCByYXdFbnRyaWVzID0gZW50cnlSZXN1bHQ/LmVudHJpZXMgPz8gW107XG4gIGNvbnN0IGRyb3BwZWRFbnRyaWVzQ291bnQgPSBlbnRyeVJlc3VsdD8uZHJvcHBlZEVudHJpZXNDb3VudDtcbiAgaWYgKHJhd0VudHJpZXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGVudHJpZXMgPSByYXdFbnRyaWVzLm1hcChyYXdUb1BlcmZvcm1hbmNlRW50cnkpO1xuICBmb3IgKGNvbnN0IFtvYnNlcnZlciwgb2JzZXJ2ZXJDb25maWddIG9mIHJlZ2lzdGVyZWRPYnNlcnZlcnMuZW50cmllcygpKSB7XG4gICAgY29uc3QgZW50cmllc0Zvck9ic2VydmVyOiBQZXJmb3JtYW5jZUVudHJ5TGlzdCA9IGVudHJpZXMuZmlsdGVyKGVudHJ5ID0+IHtcbiAgICAgIGlmICghb2JzZXJ2ZXJDb25maWcuZW50cnlUeXBlcy5oYXMoZW50cnkuZW50cnlUeXBlKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBjb25zdCBkdXJhdGlvblRocmVzaG9sZCA9IG9ic2VydmVyQ29uZmlnLmVudHJ5VHlwZXMuZ2V0KGVudHJ5LmVudHJ5VHlwZSk7XG4gICAgICByZXR1cm4gZW50cnkuZHVyYXRpb24gPj0gKGR1cmF0aW9uVGhyZXNob2xkID8/IDApO1xuICAgIH0pO1xuICAgIG9ic2VydmVyQ29uZmlnLmNhbGxiYWNrKFxuICAgICAgbmV3IFBlcmZvcm1hbmNlT2JzZXJ2ZXJFbnRyeUxpc3QoZW50cmllc0Zvck9ic2VydmVyKSxcbiAgICAgIG9ic2VydmVyLFxuICAgICAgZHJvcHBlZEVudHJpZXNDb3VudCxcbiAgICApO1xuICB9XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gd2Fybk5vTmF0aXZlUGVyZm9ybWFuY2VPYnNlcnZlcigpIHtcbiAgd2Fybk9uY2UoXG4gICAgJ21pc3NpbmctbmF0aXZlLXBlcmZvcm1hbmNlLW9ic2VydmVyJyxcbiAgICAnTWlzc2luZyBuYXRpdmUgaW1wbGVtZW50YXRpb24gb2YgUGVyZm9ybWFuY2VPYnNlcnZlcicsXG4gICk7XG59XG5cbmZ1bmN0aW9uIGFwcGx5RHVyYXRpb25UaHJlc2hvbGRzKCkge1xuICBjb25zdCBkdXJhdGlvblRocmVzaG9sZHM6IE1hcDxQZXJmb3JtYW5jZUVudHJ5VHlwZSwgP251bWJlcj4gPSBBcnJheS5mcm9tKFxuICAgIHJlZ2lzdGVyZWRPYnNlcnZlcnMudmFsdWVzKCksXG4gIClcbiAgICAubWFwKGNvbmZpZyA9PiBjb25maWcuZW50cnlUeXBlcylcbiAgICAucmVkdWNlKFxuICAgICAgKGFjY3VtdWxhdG9yLCBjdXJyZW50VmFsdWUpID0+IHVuaW9uKGFjY3VtdWxhdG9yLCBjdXJyZW50VmFsdWUpLFxuICAgICAgbmV3IE1hcCgpLFxuICAgICk7XG5cbiAgZm9yIChjb25zdCBbZW50cnlUeXBlLCBkdXJhdGlvblRocmVzaG9sZF0gb2YgZHVyYXRpb25UaHJlc2hvbGRzKSB7XG4gICAgTmF0aXZlUGVyZm9ybWFuY2VPYnNlcnZlcj8uc2V0RHVyYXRpb25UaHJlc2hvbGQoXG4gICAgICBwZXJmb3JtYW5jZUVudHJ5VHlwZVRvUmF3KGVudHJ5VHlwZSksXG4gICAgICBkdXJhdGlvblRocmVzaG9sZCA/PyAwLFxuICAgICk7XG4gIH1cbn1cblxuLyoqXG4gKiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgUGVyZm9ybWFuY2VPYnNlcnZlciBpbnRlcmZhY2UgZm9yIFJOLFxuICogY29ycmVzcG9uZGluZyB0byB0aGUgc3RhbmRhcmQgaW4gaHR0cHM6Ly93d3cudzMub3JnL1RSL3BlcmZvcm1hbmNlLXRpbWVsaW5lL1xuICpcbiAqIEBleGFtcGxlXG4gKiBjb25zdCBvYnNlcnZlciA9IG5ldyBQZXJmb3JtYW5jZU9ic2VydmVyKChsaXN0LCBfb2JzZXJ2ZXIpID0+IHtcbiAqICAgY29uc3QgZW50cmllcyA9IGxpc3QuZ2V0RW50cmllcygpO1xuICogICBlbnRyaWVzLmZvckVhY2goZW50cnkgPT4ge1xuICogICAgIHJlcG9ydEV2ZW50KHtcbiAqICAgICAgIGV2ZW50TmFtZTogZW50cnkubmFtZSxcbiAqICAgICAgIHN0YXJ0VGltZTogZW50cnkuc3RhcnRUaW1lLFxuICogICAgICAgZW5kVGltZTogZW50cnkuc3RhcnRUaW1lICsgZW50cnkuZHVyYXRpb24sXG4gKiAgICAgICBwcm9jZXNzaW5nU3RhcnQ6IGVudHJ5LnByb2Nlc3NpbmdTdGFydCxcbiAqICAgICAgIHByb2Nlc3NpbmdFbmQ6IGVudHJ5LnByb2Nlc3NpbmdFbmQsXG4gKiAgICAgICBpbnRlcmFjdGlvbklkOiBlbnRyeS5pbnRlcmFjdGlvbklkLFxuICogICAgIH0pO1xuICogICB9KTtcbiAqIH0pO1xuICogb2JzZXJ2ZXIub2JzZXJ2ZSh7IHR5cGU6IFwiZXZlbnRcIiB9KTtcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGVyZm9ybWFuY2VPYnNlcnZlciB7XG4gIF9jYWxsYmFjazogUGVyZm9ybWFuY2VPYnNlcnZlckNhbGxiYWNrO1xuICBfdHlwZTogJ3NpbmdsZScgfCAnbXVsdGlwbGUnIHwgdm9pZDtcblxuICBjb25zdHJ1Y3RvcihjYWxsYmFjazogUGVyZm9ybWFuY2VPYnNlcnZlckNhbGxiYWNrKSB7XG4gICAgdGhpcy5fY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgfVxuXG4gIG9ic2VydmUob3B0aW9uczogUGVyZm9ybWFuY2VPYnNlcnZlckluaXQpOiB2b2lkIHtcbiAgICBpZiAoIU5hdGl2ZVBlcmZvcm1hbmNlT2JzZXJ2ZXIpIHtcbiAgICAgIHdhcm5Ob05hdGl2ZVBlcmZvcm1hbmNlT2JzZXJ2ZXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLl92YWxpZGF0ZU9ic2VydmVPcHRpb25zKG9wdGlvbnMpO1xuXG4gICAgbGV0IHJlcXVlc3RlZEVudHJ5VHlwZXM7XG5cbiAgICBpZiAob3B0aW9ucy5lbnRyeVR5cGVzKSB7XG4gICAgICB0aGlzLl90eXBlID0gJ211bHRpcGxlJztcbiAgICAgIHJlcXVlc3RlZEVudHJ5VHlwZXMgPSBuZXcgTWFwKFxuICAgICAgICBvcHRpb25zLmVudHJ5VHlwZXMubWFwKHQgPT4gW3QsIHVuZGVmaW5lZF0pLFxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fdHlwZSA9ICdzaW5nbGUnO1xuICAgICAgcmVxdWVzdGVkRW50cnlUeXBlcyA9IG5ldyBNYXAoW1xuICAgICAgICBbb3B0aW9ucy50eXBlLCBvcHRpb25zLmR1cmF0aW9uVGhyZXNob2xkXSxcbiAgICAgIF0pO1xuICAgIH1cblxuICAgIC8vIFRoZSBzYW1lIG9ic2VydmVyIG1heSByZWNlaXZlIG11bHRpcGxlIGNhbGxzIHRvIFwib2JzZXJ2ZVwiLCBzbyB3ZSBuZWVkXG4gICAgLy8gdG8gY2hlY2sgd2hhdCBpcyBuZXcgb24gdGhpcyBjYWxsIHZzLiBwcmV2aW91cyBvbmVzLlxuICAgIGNvbnN0IGN1cnJlbnRFbnRyeVR5cGVzID0gcmVnaXN0ZXJlZE9ic2VydmVycy5nZXQodGhpcyk/LmVudHJ5VHlwZXM7XG4gICAgY29uc3QgbmV4dEVudHJ5VHlwZXMgPSBjdXJyZW50RW50cnlUeXBlc1xuICAgICAgPyB1bmlvbihyZXF1ZXN0ZWRFbnRyeVR5cGVzLCBjdXJyZW50RW50cnlUeXBlcylcbiAgICAgIDogcmVxdWVzdGVkRW50cnlUeXBlcztcblxuICAgIC8vIFRoaXMgYG9ic2VydmVgIGNhbGwgaXMgYSBuby1vcCBiZWNhdXNlIHRoZXJlIGFyZSBubyBuZXcgdGhpbmdzIHRvIG9ic2VydmUuXG4gICAgaWYgKGN1cnJlbnRFbnRyeVR5cGVzICYmIGN1cnJlbnRFbnRyeVR5cGVzLnNpemUgPT09IG5leHRFbnRyeVR5cGVzLnNpemUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICByZWdpc3RlcmVkT2JzZXJ2ZXJzLnNldCh0aGlzLCB7XG4gICAgICBjYWxsYmFjazogdGhpcy5fY2FsbGJhY2ssXG4gICAgICBlbnRyeVR5cGVzOiBuZXh0RW50cnlUeXBlcyxcbiAgICB9KTtcblxuICAgIGlmICghaXNPblBlcmZvcm1hbmNlRW50cnlDYWxsYmFja1NldCkge1xuICAgICAgTmF0aXZlUGVyZm9ybWFuY2VPYnNlcnZlci5zZXRPblBlcmZvcm1hbmNlRW50cnlDYWxsYmFjayhcbiAgICAgICAgb25QZXJmb3JtYW5jZUVudHJ5LFxuICAgICAgKTtcbiAgICAgIGlzT25QZXJmb3JtYW5jZUVudHJ5Q2FsbGJhY2tTZXQgPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIFdlIG9ubHkgbmVlZCB0byBzdGFydCBsaXN0ZW5lbmluZyB0byBuZXcgZW50cnkgdHlwZXMgYmVpbmcgb2JzZXJ2ZWQgaW5cbiAgICAvLyB0aGlzIG9ic2VydmVyLlxuICAgIGNvbnN0IG5ld0VudHJ5VHlwZXMgPSBjdXJyZW50RW50cnlUeXBlc1xuICAgICAgPyBkaWZmZXJlbmNlKFxuICAgICAgICAgIG5ldyBTZXQocmVxdWVzdGVkRW50cnlUeXBlcy5rZXlzKCkpLFxuICAgICAgICAgIG5ldyBTZXQoY3VycmVudEVudHJ5VHlwZXMua2V5cygpKSxcbiAgICAgICAgKVxuICAgICAgOiBuZXcgU2V0KHJlcXVlc3RlZEVudHJ5VHlwZXMua2V5cygpKTtcbiAgICBmb3IgKGNvbnN0IHR5cGUgb2YgbmV3RW50cnlUeXBlcykge1xuICAgICAgaWYgKCFvYnNlcnZlckNvdW50UGVyRW50cnlUeXBlLmhhcyh0eXBlKSkge1xuICAgICAgICBjb25zdCByYXdUeXBlID0gcGVyZm9ybWFuY2VFbnRyeVR5cGVUb1Jhdyh0eXBlKTtcbiAgICAgICAgTmF0aXZlUGVyZm9ybWFuY2VPYnNlcnZlci5zdGFydFJlcG9ydGluZyhyYXdUeXBlKTtcbiAgICAgIH1cbiAgICAgIG9ic2VydmVyQ291bnRQZXJFbnRyeVR5cGUuc2V0KFxuICAgICAgICB0eXBlLFxuICAgICAgICAob2JzZXJ2ZXJDb3VudFBlckVudHJ5VHlwZS5nZXQodHlwZSkgPz8gMCkgKyAxLFxuICAgICAgKTtcbiAgICB9XG4gICAgYXBwbHlEdXJhdGlvblRocmVzaG9sZHMoKTtcbiAgfVxuXG4gIGRpc2Nvbm5lY3QoKTogdm9pZCB7XG4gICAgaWYgKCFOYXRpdmVQZXJmb3JtYW5jZU9ic2VydmVyKSB7XG4gICAgICB3YXJuTm9OYXRpdmVQZXJmb3JtYW5jZU9ic2VydmVyKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qgb2JzZXJ2ZXJDb25maWcgPSByZWdpc3RlcmVkT2JzZXJ2ZXJzLmdldCh0aGlzKTtcbiAgICBpZiAoIW9ic2VydmVyQ29uZmlnKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gRGlzY29ubmVjdCB0aGlzIG9ic2VydmVyXG4gICAgZm9yIChjb25zdCB0eXBlIG9mIG9ic2VydmVyQ29uZmlnLmVudHJ5VHlwZXMua2V5cygpKSB7XG4gICAgICBjb25zdCBudW1iZXJPZk9ic2VydmVyc0ZvclRoaXNUeXBlID1cbiAgICAgICAgb2JzZXJ2ZXJDb3VudFBlckVudHJ5VHlwZS5nZXQodHlwZSkgPz8gMDtcbiAgICAgIGlmIChudW1iZXJPZk9ic2VydmVyc0ZvclRoaXNUeXBlID09PSAxKSB7XG4gICAgICAgIG9ic2VydmVyQ291bnRQZXJFbnRyeVR5cGUuZGVsZXRlKHR5cGUpO1xuICAgICAgICBOYXRpdmVQZXJmb3JtYW5jZU9ic2VydmVyLnN0b3BSZXBvcnRpbmcoXG4gICAgICAgICAgcGVyZm9ybWFuY2VFbnRyeVR5cGVUb1Jhdyh0eXBlKSxcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSBpZiAobnVtYmVyT2ZPYnNlcnZlcnNGb3JUaGlzVHlwZSAhPT0gMCkge1xuICAgICAgICBvYnNlcnZlckNvdW50UGVyRW50cnlUeXBlLnNldCh0eXBlLCBudW1iZXJPZk9ic2VydmVyc0ZvclRoaXNUeXBlIC0gMSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRGlzY29ubmVjdCBhbGwgb2JzZXJ2ZXJzIGlmIHRoaXMgd2FzIHRoZSBsYXN0IG9uZVxuICAgIHJlZ2lzdGVyZWRPYnNlcnZlcnMuZGVsZXRlKHRoaXMpO1xuICAgIGlmIChyZWdpc3RlcmVkT2JzZXJ2ZXJzLnNpemUgPT09IDApIHtcbiAgICAgIE5hdGl2ZVBlcmZvcm1hbmNlT2JzZXJ2ZXIuc2V0T25QZXJmb3JtYW5jZUVudHJ5Q2FsbGJhY2sodW5kZWZpbmVkKTtcbiAgICAgIGlzT25QZXJmb3JtYW5jZUVudHJ5Q2FsbGJhY2tTZXQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBhcHBseUR1cmF0aW9uVGhyZXNob2xkcygpO1xuICB9XG5cbiAgX3ZhbGlkYXRlT2JzZXJ2ZU9wdGlvbnMob3B0aW9uczogUGVyZm9ybWFuY2VPYnNlcnZlckluaXQpOiB2b2lkIHtcbiAgICBjb25zdCB7dHlwZSwgZW50cnlUeXBlcywgZHVyYXRpb25UaHJlc2hvbGR9ID0gb3B0aW9ucztcblxuICAgIGlmICghdHlwZSAmJiAhZW50cnlUeXBlcykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgICAgXCJGYWlsZWQgdG8gZXhlY3V0ZSAnb2JzZXJ2ZScgb24gJ1BlcmZvcm1hbmNlT2JzZXJ2ZXInOiBBbiBvYnNlcnZlKCkgY2FsbCBtdXN0IG5vdCBpbmNsdWRlIGJvdGggZW50cnlUeXBlcyBhbmQgdHlwZSBhcmd1bWVudHMuXCIsXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChlbnRyeVR5cGVzICYmIHR5cGUpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgIFwiRmFpbGVkIHRvIGV4ZWN1dGUgJ29ic2VydmUnIG9uICdQZXJmb3JtYW5jZU9ic2VydmVyJzogQW4gb2JzZXJ2ZSgpIGNhbGwgbXVzdCBpbmNsdWRlIGVpdGhlciBlbnRyeVR5cGVzIG9yIHR5cGUgYXJndW1lbnRzLlwiLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5fdHlwZSA9PT0gJ211bHRpcGxlJyAmJiB0eXBlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIFwiRmFpbGVkIHRvIGV4ZWN1dGUgJ29ic2VydmUnIG9uICdQZXJmb3JtYW5jZU9ic2VydmVyJzogVGhpcyBvYnNlcnZlciBoYXMgcGVyZm9ybWVkIG9ic2VydmUoe2VudHJ5VHlwZXM6Li4ufSwgdGhlcmVmb3JlIGl0IGNhbm5vdCBwZXJmb3JtIG9ic2VydmUoe3R5cGU6Li4ufSlcIixcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX3R5cGUgPT09ICdzaW5nbGUnICYmIGVudHJ5VHlwZXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgXCJGYWlsZWQgdG8gZXhlY3V0ZSAnb2JzZXJ2ZScgb24gJ1BlcmZvcm1hbmNlT2JzZXJ2ZXInOiBUaGlzIFBlcmZvcm1hbmNlT2JzZXJ2ZXIgaGFzIHBlcmZvcm1lZCBvYnNlcnZlKHt0eXBlOi4uLn0sIHRoZXJlZm9yZSBpdCBjYW5ub3QgcGVyZm9ybSBvYnNlcnZlKHtlbnRyeVR5cGVzOi4uLn0pXCIsXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChlbnRyeVR5cGVzICYmIGR1cmF0aW9uVGhyZXNob2xkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXG4gICAgICAgIFwiRmFpbGVkIHRvIGV4ZWN1dGUgJ29ic2VydmUnIG9uICdQZXJmb3JtYW5jZU9ic2VydmVyJzogQW4gb2JzZXJ2ZSgpIGNhbGwgbXVzdCBub3QgaW5jbHVkZSBib3RoIGVudHJ5VHlwZXMgYW5kIGR1cmF0aW9uVGhyZXNob2xkIGFyZ3VtZW50cy5cIixcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgc3RhdGljIHN1cHBvcnRlZEVudHJ5VHlwZXM6ICRSZWFkT25seUFycmF5PFBlcmZvcm1hbmNlRW50cnlUeXBlPiA9XG4gICAgT2JqZWN0LmZyZWV6ZShbJ21hcmsnLCAnbWVhc3VyZScsICdldmVudCddKTtcbn1cblxuLy8gQXMgYSBTZXQgdW5pb24sIGV4Y2VwdCBpZiB2YWx1ZSBleGlzdHMgaW4gYm90aCwgd2UgdGFrZSBtaW5pbXVtXG5mdW5jdGlvbiB1bmlvbjxUPihcbiAgYTogJFJlYWRPbmx5TWFwPFQsID9udW1iZXI+LFxuICBiOiAkUmVhZE9ubHlNYXA8VCwgP251bWJlcj4sXG4pOiBNYXA8VCwgP251bWJlcj4ge1xuICBjb25zdCByZXMgPSBuZXcgTWFwPFQsID9udW1iZXI+KCk7XG4gIGZvciAoY29uc3QgW2ssIHZdIG9mIGEpIHtcbiAgICBpZiAoIWIuaGFzKGspKSB7XG4gICAgICByZXMuc2V0KGssIHYpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXMuc2V0KGssIE1hdGgubWluKHYgPz8gMCwgYi5nZXQoaykgPz8gMCkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzO1xufVxuXG5mdW5jdGlvbiBkaWZmZXJlbmNlPFQ+KGE6ICRSZWFkT25seVNldDxUPiwgYjogJFJlYWRPbmx5U2V0PFQ+KTogU2V0PFQ+IHtcbiAgcmV0dXJuIG5ldyBTZXQoWy4uLmFdLmZpbHRlcih4ID0+ICFiLmhhcyh4KSkpO1xufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBWUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsMEJBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLGlCQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxvQkFBQSxHQUFBSCxPQUFBO0FBRytCLElBSWxCSSw0QkFBNEIsR0FBQUMsT0FBQSxDQUFBRCw0QkFBQTtFQUd2QyxTQUFBQSw2QkFBWUUsT0FBNkIsRUFBRTtJQUFBLElBQUFDLGdCQUFBLENBQUFDLE9BQUEsUUFBQUosNEJBQUE7SUFDekMsSUFBSSxDQUFDSyxRQUFRLEdBQUdILE9BQU87RUFDekI7RUFBQyxXQUFBSSxhQUFBLENBQUFGLE9BQUEsRUFBQUosNEJBQUE7SUFBQU8sR0FBQTtJQUFBQyxLQUFBLEVBRUQsU0FBQUMsVUFBVUEsQ0FBQSxFQUF5QjtNQUNqQyxPQUFPLElBQUksQ0FBQ0osUUFBUTtJQUN0QjtFQUFDO0lBQUFFLEdBQUE7SUFBQUMsS0FBQSxFQUVELFNBQUFFLGdCQUFnQkEsQ0FBQ0MsSUFBMEIsRUFBd0I7TUFDakUsT0FBTyxJQUFJLENBQUNOLFFBQVEsQ0FBQ08sTUFBTSxDQUFDLFVBQUFDLEtBQUs7UUFBQSxPQUFJQSxLQUFLLENBQUNDLFNBQVMsS0FBS0gsSUFBSTtNQUFBLEVBQUM7SUFDaEU7RUFBQztJQUFBSixHQUFBO0lBQUFDLEtBQUEsRUFFRCxTQUFBTyxnQkFBZ0JBLENBQ2RDLElBQVksRUFDWkwsSUFBMkIsRUFDTDtNQUN0QixJQUFJQSxJQUFJLEtBQUtNLFNBQVMsRUFBRTtRQUN0QixPQUFPLElBQUksQ0FBQ1osUUFBUSxDQUFDTyxNQUFNLENBQUMsVUFBQUMsS0FBSztVQUFBLE9BQUlBLEtBQUssQ0FBQ0csSUFBSSxLQUFLQSxJQUFJO1FBQUEsRUFBQztNQUMzRCxDQUFDLE1BQU07UUFDTCxP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W119